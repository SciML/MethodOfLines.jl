<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>How it Works · MethodOfLines.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://docs.sciml.ai/MethodOfLines/stable/howitworks/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="MethodOfLines.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MethodOfLines.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">MethodOfLines.jl: Automated Finite Difference for Physics-Informed Learning</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/brusselator/">Tutorial</a></li><li><a class="tocitem" href="../tutorials/heat/">Solving the Heat Equation</a></li><li><a class="tocitem" href="../tutorials/params/">Adding parameters</a></li><li><a class="tocitem" href="../tutorials/heatss/">Steady State Heat Equation - No Time Dependance - NonlinearProblem</a></li><li><a class="tocitem" href="../tutorials/sispde/">Steady state of SIS (suspected-infected-suspected) reaction-diffusion  model</a></li><li><a class="tocitem" href="../tutorials/icbc_sampled/">Initial and Boundary Conditions with sampled/measured Data</a></li></ul></li><li><a class="tocitem" href="../MOLFiniteDifference/">MOLFiniteDifference</a></li><li><a class="tocitem" href="../solutions/">Solution Interface - PDESolutions</a></li><li><a class="tocitem" href="../get_grid/">Grid and Solution Retrieval - Deprecated</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary Conditions</a></li><li><a class="tocitem" href="../advection_schemes/">Advection Schemes</a></li><li><a class="tocitem" href="../nonuniform/">Non-Uniform Rectilinear Grids</a></li><li><a class="tocitem" href="../curvilinear_grids/">Curvilinear Grids</a></li><li class="is-active"><a class="tocitem" href>How it Works</a></li><li><a class="tocitem" href="../devnotes/">Notes for Developers: Implement a Scheme</a></li><li><span class="tocitem">Generated Examples</span><ul><li><a class="tocitem" href="../generated/bruss_code/">Generated Code for the Brusselator Equation</a></li><li><a class="tocitem" href="../generated/bruss_ode_eqs/">Generated ODE system for the Brusselator Equation</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../api/discretization/">Discretization</a></li><li><a class="tocitem" href="../api/utils/">Utilities</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>How it Works</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>How it Works</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/MethodOfLines.jl/blob/master/docs/src/howitworks.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="hiw"><a class="docs-heading-anchor" href="#hiw">How it works</a><a id="hiw-1"></a><a class="docs-heading-anchor-permalink" href="#hiw" title="Permalink"></a></h1><p>MethodOfLines.jl makes heavy use of <code>Symbolics.jl</code> and <code>SymbolicUtils.jl</code>, namely it&#39;s rule matching features to recognize terms which require particular discretizations.</p><p>See <a href="https://github.com/SciML/MethodOfLines.jl/blob/master/src/MOL_discretization.jl">here</a> for the highest level overview of the algorithm.</p><p>Given your discretization and <code>PDESystem</code>, we take each independent variable defined on the space to be discretized and create a corresponding range. We then take each dependant variable and create an array of symbolic variables to represent it in its discretized form. This is stored in a <a href="https://github.com/SciML/MethodOfLines.jl/blob/master/src/discretization/discretize_vars.jl"><code>DiscreteSpace</code></a> object, a useful abstraction.</p><p>We recognize boundary conditions, i.e whether they are on the upper or lower ends of the domain, or periodic <a href="https://github.com/SciML/MethodOfLines.jl/blob/master/src/system_parsing/bcs/parse_boundaries.jl">here</a>, and use this information to construct the interior of the domain for each equation <a href="https://github.com/SciML/MethodOfLines.jl/blob/master/src/system_parsing/interiormap.jl">here</a>. Each PDE is matched to each dependant variable in this step by which variable is highest order in each PDE, with precedance given to time derivatives. This dictates which boundary conditions reduce the size of the interior for which PDE. This is done to ensure that there will be the same number of equations as discrete variable states, so that the system of equations is balanced.</p><p>Next, the boundary conditions are discretized, creating an equation for each point on the boundary in terms of the discretized variables, replacing any space derivatives in the direction of the boundary with their upwind finite difference expressions. <a href="https://github.com/SciML/MethodOfLines.jl/blob/master/src/discretization/generate_bc_eqs.jl">This</a> is the place to look to see how this happens.</p><p>After that, the system of PDEs is discretized creating a finite difference equation for each point in their interior. Specific terms are recognized, and the best implemented scheme for these terms dispatched. For example advection terms are discretized with the upwind scheme. There are also special schemes for the nonlinear laplacian and spherical laplacian. See <a href="https://github.com/SciML/MethodOfLines.jl/blob/master/src/discretization/generate_finite_difference_rules.jl">here for how this term matching occurs</a>, note that the order the generated rules are applied is important, with more specific rules applied first to avoid their terms being matched incorrectly by more general rules.  The <a href="https://symbolicutils.juliasymbolics.org/rewrite/">SymbolicUtils.jl docs</a> are a useful companion here. See <a href="https://github.com/SciML/MethodOfLines.jl/blob/master/src/discretization/differential_discretizer.jl">here for the practical implementation of the finite difference schemes</a>.</p><p>Now we have a system of equations which are either ODEs, linear, or nonlinear equations and an equal number of unknowns. See <a href="../generated/bruss_ode_eqs/#brusssys">here for the system</a> that is generated for the Brusselator at low point count. The structure of the system is simplified with <code>ModelingToolkit.structural_simplify</code>, and then either an <code>ODEProblem</code> or <code>NonlinearProblem</code> is returned. Under the hood, the <code>ODEProblem</code> generates a fast semidiscretization, written in Julia with <code>RuntimeGeneratedFunctions</code>. See <a href="../generated/bruss_code/#brusscode">here for an example of the generated code</a> for the Brusselator system at low point count. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../curvilinear_grids/">« Curvilinear Grids</a><a class="docs-footer-nextpage" href="../devnotes/">Notes for Developers: Implement a Scheme »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 6 December 2022 16:53">Tuesday 6 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
